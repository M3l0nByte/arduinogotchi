#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 32

#define JOY_X A0
#define PET_BUTTON 8   // ðŸ‘ˆ real button pin

Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, -1);

// ---------------- STATS ----------------
int hunger = 80;     // 0 = starving, 100 = full
int happiness = 80;  // 0 = sad, 100 = happy

unsigned long lastDecay = 0;

// ---------------- SETUP ----------------
void setup() {
  pinMode(PET_BUTTON, INPUT_PULLUP);

  if (!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) {
    while (true);
  }

  display.clearDisplay();
  display.display();
}

// ---------------- DRAW ----------------
void drawPet() {
  // Body
  display.fillCircle(64, 18, 10, SSD1306_WHITE);

  // Eyes
  display.fillCircle(60, 16, 2, SSD1306_BLACK);
  display.fillCircle(68, 16, 2, SSD1306_BLACK);

  // Mouth (mood-based)
  if (hunger < 30 || happiness < 30) {
    display.drawLine(60, 22, 68, 22, SSD1306_BLACK); // sad
  } else {
    display.drawLine(60, 20, 68, 20, SSD1306_BLACK); // happy
  }
}

void drawBars() {
  // Hunger bar
  display.drawRect(2, 2, 50, 6, SSD1306_WHITE);
  display.fillRect(2, 2, hunger / 2, 6, SSD1306_WHITE);

  // Happiness bar
  display.drawRect(76, 2, 50, 6, SSD1306_WHITE);
  display.fillRect(76, 2, happiness / 2, 6, SSD1306_WHITE);
}

// ---------------- LOOP ----------------
void loop() {
  display.clearDisplay();

  int joyX = analogRead(JOY_X);
  bool petPressed = digitalRead(PET_BUTTON) == LOW;

  // ----- INPUT -----
  if (joyX < 400) {          // FEED
    hunger += 1;
  } 
  else if (joyX > 600) {    // PLAY
    happiness += 1;
  }

  if (petPressed) {         // PET BUTTON
    happiness += 2;
    delay(200);             // simple debounce
  }

  // Clamp values
  hunger = constrain(hunger, 0, 100);
  happiness = constrain(happiness, 0, 100);

  // ----- TIME DECAY -----
  if (millis() - lastDecay > 2000) {
    lastDecay = millis();
    hunger -= 1;
    happiness -= 1;
  }

  hunger = constrain(hunger, 0, 100);
  happiness = constrain(happiness, 0, 100);

  // ----- DRAW -----
  drawBars();
  drawPet();

  display.display();
  delay(30);
}
// made by techamelon
